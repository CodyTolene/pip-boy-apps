function Wasteland(){function h(){bC.clear(1);for(let b=0;b<e;b++){const m=(b-e/2)/e*r;const d=a.angle+m;const n=Math.cos(d);const o=Math.sin(d);let c=0,g=a.x,h=a.y;while(c<s&&!j(g,h))g+=n*i,h+=o*i,c+=i;const k=Math.min(f,f/(c+.1));const p=c<2?3:c<4?2:1;const l=v+b*u;bC.setColor(p),bC.drawLine(l,(f-k)/2,l,(f+k)/2)}bC.flip()}function w(e,f,h){g.setColor('#FFF');const d=2*h;const c=4*h;const i=3*h;const j=1*h;const a=c*.707;const b=(a,b)=>g.fillRect(e+a-d/2,f+b-d/2,e+a+d/2,f+b+d/2);b(-c,0),b(c,0),b(0,-c),b(0,c),b(-a,-a),b(a,-a),b(-a,a),b(a,a),g.fillCircle(e,f,i),g.setColor('#000'),g.fillCircle(e,f,j)}function j(d,e){const c=Math.floor(d);const a=Math.floor(e);return b[a]&&b[a][c]==='#'}function x(){const d=Math.cos(a.angle);const e=Math.sin(a.angle);const b=a.x-d;const c=a.y-e;j(b,c)?Pip.audioStart('USER/Wasteland/OOF.wav'):(a.x=b,a.y=c,Pip.audioStart('USER/Wasteland/F_STEP.wav')),h()}function y(){const d=Math.cos(a.angle);const e=Math.sin(a.angle);const b=a.x+d;const c=a.y+e;j(b,c)?Pip.audioStart('USER/Wasteland/OOF.wav'):(a.x=b,a.y=c,Pip.audioStart('USER/Wasteland/F_STEP.wav')),h()}function m(b){a.angle+=Math.PI/4*b,a.angle<0?a.angle+=Math.PI*2:a.angle>Math.PI*2&&(a.angle-=Math.PI*2),Pip.audioStart('USER/Wasteland/F_STEP_2.wav'),h()}const k={};const n='Wasteland';const o='1.1.0';const c=g.getWidth();const d=g.getHeight();const p='#0F0';const q='#FFF';const b=['###################','#                 #','#                 #','#   ####   ####   #','#                 #','#        V        #','#                 #','#   ###########   #','#                 #','#                 #','###################'];const e=13;const r=Math.PI/3;const s=8;const i=.2;const l=150;const t=g.getWidth()-l;const f=g.getHeight();const u=Math.floor(t/e);const v=l/3;const a={x:1,y:1,angle:0,speed:1};for(let g=0;g<b.length;g++){const c=b[g].indexOf('V');if(c!==-1){a.x=c+.5,a.y=g+.5,b[g]=b[g].substring(0,c)+' '+b[g].substring(c+1);break}}return k.run=function(){g.clear(),g.setColor(p),g.setFont('6x8',4),g.drawString(n,c/2,d/2-20),g.setColor(q),g.setFont('6x8',2),g.drawString('Press   to START',c/2,d/2+15),g.setFont('6x8',1),g.drawString(' v'+o,c/2-5,d-20),w(c/2-20,d/2+15,2.5),g.setFont('6x8',1);const a=setInterval(()=>{if(BTN_PLAY.read()){clearInterval(a),h(),Pip.removeAllListeners('knob1'),Pip.on('knob1',function(a){a===0?x():m(a)}),Pip.removeAllListeners('knob2'),Pip.on('knob2',function(a){m(a)});const b=setInterval(()=>{BTN_PLAY.read()?y():BTN_TORCH.read()&&(clearInterval(b),bC.clear(1).flip(),E.reboot())},100)}},100)},k}Wasteland().run()